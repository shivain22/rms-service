# Custom Endpoints Specification - Restaurant Management System

## Overview

This document lists all custom endpoints required beyond standard CRUD operations generated by JHipster. Each endpoint includes:

- HTTP method and path
- Request/Response DTOs
- Service method signature
- Location in generated code (below JHipster markers)

## JHipster Markers

JHipster generates code with markers where custom code should be added:

**In REST Controllers:**

```java
// jhipster-needle-rest-add-get-method - JHipster will add get methods here
// jhipster-needle-rest-add-post-method - JHipster will add post methods here
// jhipster-needle-rest-add-put-method - JHipster will add put methods here
// jhipster-needle-rest-add-delete-method - JHipster will add delete methods here
// jhipster-needle-rest-add-patch-method - JHipster will add patch methods here

```

**In Service Interfaces:**

```java
// jhipster-needle-service-add-method - JHipster will add methods here

```

**In Service Implementations:**

```java
// jhipster-needle-service-impl-add-method - JHipster will add methods here

```

---

## 1. RmsUser Resource (`RmsUserResource`)

### 1.1 Sync User with Gateway/Keycloak

**Endpoint:** `POST /api/rms-users/{id}/sync`
**Purpose:** Trigger synchronization of user with Gateway/Keycloak

```java
// jhipster-needle-rest-add-post-method - JHipster will add post methods here

/**
 * {@code POST /api/rms-users/{id}/sync} : Sync user with Gateway/Keycloak
 *
 * @param id the id of the user to sync
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and sync result
 */
@PostMapping("/rms-users/{id}/sync")
public Mono<ResponseEntity<UserSyncLogDTO>> syncUser(@PathVariable UUID id) {
  log.debug("REST request to sync user with Gateway/Keycloak : {}", id);
  return rmsUserService.syncUserWithGateway(id).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
// jhipster-needle-service-add-method - JHipster will add methods here

/**
 * Sync user with Gateway/Keycloak
 *
 * @param userId the id of the user
 * @return the sync log DTO
 */
Mono<UserSyncLogDTO> syncUserWithGateway(UUID userId);

```

### 1.2 Get User by External ID

**Endpoint:** `GET /api/rms-users/external/{externalUserId}`
**Purpose:** Find user by external user ID from Gateway/Keycloak

```java
// jhipster-needle-rest-add-get-method - JHipster will add get methods here

/**
 * {@code GET /api/rms-users/external/{externalUserId}} : Get user by external ID
 *
 * @param externalUserId the external user ID
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and user DTO
 */
@GetMapping("/rms-users/external/{externalUserId}")
public Mono<ResponseEntity<RmsUserDTO>> getUserByExternalId(@PathVariable String externalUserId) {
  log.debug("REST request to get user by external ID : {}", externalUserId);
  return rmsUserService
    .findByExternalUserId(externalUserId)
    .map(result -> ResponseEntity.ok().body(result))
    .switchIfEmpty(Mono.just(ResponseEntity.notFound().build()));
}

```

**Service Method:**

```java
Mono<RmsUserDTO> findByExternalUserId(String externalUserId);

```

### 1.3 Bulk Sync Users

**Endpoint:** `POST /api/rms-users/bulk-sync`
**Purpose:** Sync multiple users with Gateway/Keycloak

```java
/**
 * {@code POST /api/rms-users/bulk-sync} : Bulk sync users with Gateway/Keycloak
 *
 * @param userIds list of user IDs to sync
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and sync results
 */
@PostMapping("/rms-users/bulk-sync")
public Mono<ResponseEntity<List<UserSyncLogDTO>>> bulkSyncUsers(@RequestBody List<UUID> userIds) {
  log.debug("REST request to bulk sync users : {}", userIds);
  return rmsUserService.bulkSyncUsers(userIds).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<UserSyncLogDTO> bulkSyncUsers(List<UUID> userIds);

```

---

## 2. UserBranchRole Resource (`UserBranchRoleResource`)

### 2.1 Assign Role to User

**Endpoint:** `POST /api/user-branch-roles/assign`
**Purpose:** Assign a role to a user for a specific branch

```java
// jhipster-needle-rest-add-post-method - JHipster will add post methods here

/**
 * {@code POST /api/user-branch-roles/assign} : Assign role to user for branch
 *
 * @param assignmentDTO the assignment details
 * @return the {@link ResponseEntity} with status {@code 201 (Created)} and user branch role DTO
 */
@PostMapping("/user-branch-roles/assign")
public Mono<ResponseEntity<UserBranchRoleDTO>> assignRole(@RequestBody UserBranchRoleAssignmentDTO assignmentDTO) {
  log.debug("REST request to assign role : {}", assignmentDTO);
  return userBranchRoleService.assignRole(assignmentDTO).map(result -> ResponseEntity.status(HttpStatus.CREATED).body(result));
}

```

**Service Method:**

```java
Mono<UserBranchRoleDTO> assignRole(UserBranchRoleAssignmentDTO assignmentDTO);

```

### 2.2 Revoke Role from User

**Endpoint:** `PUT /api/user-branch-roles/{id}/revoke`
**Purpose:** Revoke a role from a user

```java
/**
 * {@code PUT /api/user-branch-roles/{id}/revoke} : Revoke role from user
 *
 * @param id the id of the user branch role
 * @return the {@link ResponseEntity} with status {@code 200 (OK)}
 */
@PutMapping("/user-branch-roles/{id}/revoke")
public Mono<ResponseEntity<UserBranchRoleDTO>> revokeRole(@PathVariable UUID id) {
  log.debug("REST request to revoke role : {}", id);
  return userBranchRoleService.revokeRole(id).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<UserBranchRoleDTO> revokeRole(UUID id);

```

### 2.3 Get Users by Branch and Role

**Endpoint:** `GET /api/user-branch-roles/branch/{branchId}/role/{role}`
**Purpose:** Get all users with a specific role in a branch

```java
/**
 * {@code GET /api/user-branch-roles/branch/{branchId}/role/{role}} : Get users by branch and role
 *
 * @param branchId the branch ID
 * @param role the role name
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of user branch roles
 */
@GetMapping("/user-branch-roles/branch/{branchId}/role/{role}")
public Mono<ResponseEntity<List<UserBranchRoleDTO>>> getUsersByBranchAndRole(@PathVariable UUID branchId, @PathVariable String role) {
  log.debug("REST request to get users by branch and role : {} - {}", branchId, role);
  return userBranchRoleService.findByBranchIdAndRole(branchId, role).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<UserBranchRoleDTO> findByBranchIdAndRole(UUID branchId, String role);

```

---

## 3. BranchTable Resource (`BranchTableResource`)

### 3.1 Update Table Status

**Endpoint:** `PUT /api/branch-tables/{id}/status`
**Purpose:** Update table status (AVAILABLE, OCCUPIED, RESERVED, OUT_OF_SERVICE)

```java
// jhipster-needle-rest-add-put-method - JHipster will add put methods here

/**
 * {@code PUT /api/branch-tables/{id}/status} : Update table status
 *
 * @param id the id of the table
 * @param status the new status
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and updated table DTO
 */
@PutMapping("/branch-tables/{id}/status")
public Mono<ResponseEntity<BranchTableDTO>> updateTableStatus(@PathVariable UUID id, @RequestBody Map<String, String> request) {
  String status = request.get("status");
  log.debug("REST request to update table status : {} - {}", id, status);
  return branchTableService.updateStatus(id, status).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<BranchTableDTO> updateStatus(UUID id, String status);

```

### 3.2 Get Available Tables

**Endpoint:** `GET /api/branch-tables/branch/{branchId}/available`
**Purpose:** Get all available tables for a branch

```java
/**
 * {@code GET /api/branch-tables/branch/{branchId}/available} : Get available tables
 *
 * @param branchId the branch ID
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of available tables
 */
@GetMapping("/branch-tables/branch/{branchId}/available")
public Mono<ResponseEntity<List<BranchTableDTO>>> getAvailableTables(@PathVariable UUID branchId) {
  log.debug("REST request to get available tables for branch : {}", branchId);
  return branchTableService.findAvailableByBranchId(branchId).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<BranchTableDTO> findAvailableByBranchId(UUID branchId);

```

### 3.3 Get Tables by Status

**Endpoint:** `GET /api/branch-tables/branch/{branchId}/status/{status}`
**Purpose:** Get tables by status for a branch

```java
/**
 * {@code GET /api/branch-tables/branch/{branchId}/status/{status}} : Get tables by status
 *
 * @param branchId the branch ID
 * @param status the table status
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of tables
 */
@GetMapping("/branch-tables/branch/{branchId}/status/{status}")
public Mono<ResponseEntity<List<BranchTableDTO>>> getTablesByStatus(@PathVariable UUID branchId, @PathVariable String status) {
  log.debug("REST request to get tables by status : {} - {}", branchId, status);
  return branchTableService.findByBranchIdAndStatus(branchId, status).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<BranchTableDTO> findByBranchIdAndStatus(UUID branchId, String status);

```

---

## 4. TableAssignment Resource (`TableAssignmentResource`)

### 4.1 Create Daily Assignments

**Endpoint:** `POST /api/table-assignments/daily`
**Purpose:** Create table assignments for a specific date

```java
// jhipster-needle-rest-add-post-method - JHipster will add post methods here

/**
 * {@code POST /api/table-assignments/daily} : Create daily table assignments
 *
 * @param assignmentRequest the assignment request
 * @return the {@link ResponseEntity} with status {@code 201 (Created)} and list of assignments
 */
@PostMapping("/table-assignments/daily")
public Mono<ResponseEntity<List<TableAssignmentDTO>>> createDailyAssignments(
  @RequestBody DailyTableAssignmentRequestDTO assignmentRequest
) {
  log.debug("REST request to create daily table assignments : {}", assignmentRequest);
  return tableAssignmentService
    .createDailyAssignments(assignmentRequest)
    .collectList()
    .map(result -> ResponseEntity.status(HttpStatus.CREATED).body(result));
}

```

**Service Method:**

```java
Flux<TableAssignmentDTO> createDailyAssignments(DailyTableAssignmentRequestDTO request);

```

### 4.2 Get Assignments for Date

**Endpoint:** `GET /api/table-assignments/date/{date}`
**Purpose:** Get all table assignments for a specific date

```java
/**
 * {@code GET /api/table-assignments/date/{date}} : Get assignments for date
 *
 * @param date the assignment date
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of assignments
 */
@GetMapping("/table-assignments/date/{date}")
public Mono<ResponseEntity<List<TableAssignmentDTO>>> getAssignmentsForDate(
  @PathVariable @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) LocalDate date
) {
  log.debug("REST request to get assignments for date : {}", date);
  return tableAssignmentService.findByAssignmentDate(date).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<TableAssignmentDTO> findByAssignmentDate(LocalDate date);

```

### 4.3 Assign Waiters to Table

**Endpoint:** `POST /api/table-assignments/{assignmentId}/waiters`
**Purpose:** Assign waiters to a table assignment

```java
/**
 * {@code POST /api/table-assignments/{assignmentId}/waiters} : Assign waiters to table
 *
 * @param assignmentId the table assignment ID
 * @param waiterIds list of waiter user IDs
 * @return the {@link ResponseEntity} with status {@code 201 (Created)} and list of waiter assignments
 */
@PostMapping("/table-assignments/{assignmentId}/waiters")
public Mono<ResponseEntity<List<TableWaiterAssignmentDTO>>> assignWaiters(
  @PathVariable UUID assignmentId,
  @RequestBody List<UUID> waiterIds
) {
  log.debug("REST request to assign waiters : {} - {}", assignmentId, waiterIds);
  return tableWaiterAssignmentService
    .assignWaiters(assignmentId, waiterIds)
    .collectList()
    .map(result -> ResponseEntity.status(HttpStatus.CREATED).body(result));
}

```

**Service Method (in TableWaiterAssignmentService):**

```java
Flux<TableWaiterAssignmentDTO> assignWaiters(UUID tableAssignmentId, List<UUID> waiterIds);

```

---

## 5. MenuItem Resource (`MenuItemResource`)

### 5.1 Update Availability

**Endpoint:** `PUT /api/menu-items/{id}/availability`
**Purpose:** Update menu item availability status

```java
// jhipster-needle-rest-add-put-method - JHipster will add put methods here

/**
 * {@code PUT /api/menu-items/{id}/availability} : Update menu item availability
 *
 * @param id the id of the menu item
 * @param request the availability request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and updated menu item DTO
 */
@PutMapping("/menu-items/{id}/availability")
public Mono<ResponseEntity<MenuItemDTO>> updateAvailability(@PathVariable UUID id, @RequestBody Map<String, Boolean> request) {
  Boolean isAvailable = request.get("isAvailable");
  log.debug("REST request to update menu item availability : {} - {}", id, isAvailable);
  return menuItemService.updateAvailability(id, isAvailable).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<MenuItemDTO> updateAvailability(UUID id, Boolean isAvailable);

```

### 5.2 Get Available Menu Items by Branch

**Endpoint:** `GET /api/menu-items/branch/{branchId}/available`
**Purpose:** Get all available menu items for a branch

```java
/**
 * {@code GET /api/menu-items/branch/{branchId}/available} : Get available menu items
 *
 * @param branchId the branch ID
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of menu items
 */
@GetMapping("/menu-items/branch/{branchId}/available")
public Mono<ResponseEntity<List<MenuItemDTO>>> getAvailableMenuItems(@PathVariable UUID branchId) {
  log.debug("REST request to get available menu items for branch : {}", branchId);
  return menuItemService.findAvailableByBranchId(branchId).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<MenuItemDTO> findAvailableByBranchId(UUID branchId);

```

### 5.3 Get Menu Items by Category

**Endpoint:** `GET /api/menu-items/category/{categoryId}`
**Purpose:** Get all menu items in a category

```java
/**
 * {@code GET /api/menu-items/category/{categoryId}} : Get menu items by category
 *
 * @param categoryId the menu category ID
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of menu items
 */
@GetMapping("/menu-items/category/{categoryId}")
public Mono<ResponseEntity<List<MenuItemDTO>>> getMenuItemsByCategory(@PathVariable UUID categoryId) {
  log.debug("REST request to get menu items by category : {}", categoryId);
  return menuItemService.findByCategoryId(categoryId).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<MenuItemDTO> findByCategoryId(UUID categoryId);

```

### 5.4 Get Menu Items by Filters

**Endpoint:** `GET /api/menu-items/branch/{branchId}/filtered`
**Purpose:** Get menu items filtered by type, cuisine, vegetarian, etc.

```java
/**
 * {@code GET /api/menu-items/branch/{branchId}/filtered} : Get filtered menu items
 *
 * @param branchId the branch ID
 * @param itemType the item type (EATABLE, BEVERAGE)
 * @param cuisineType the cuisine type
 * @param isVegetarian vegetarian filter
 * @param isAlcoholic alcoholic filter
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of menu items
 */
@GetMapping("/menu-items/branch/{branchId}/filtered")
public Mono<ResponseEntity<List<MenuItemDTO>>> getFilteredMenuItems(
  @PathVariable UUID branchId,
  @RequestParam(required = false) String itemType,
  @RequestParam(required = false) String cuisineType,
  @RequestParam(required = false) Boolean isVegetarian,
  @RequestParam(required = false) Boolean isAlcoholic
) {
  log.debug("REST request to get filtered menu items for branch : {}", branchId);
  return menuItemService
    .findFiltered(branchId, itemType, cuisineType, isVegetarian, isAlcoholic)
    .collectList()
    .map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<MenuItemDTO> findFiltered(UUID branchId, String itemType, String cuisineType, Boolean isVegetarian, Boolean isAlcoholic);

```

---

## 6. Inventory Resource (`InventoryResource`)

### 6.1 Update Stock Level

**Endpoint:** `PUT /api/inventories/{id}/stock`
**Purpose:** Update inventory stock level

```java
// jhipster-needle-rest-add-put-method - JHipster will add put methods here

/**
 * {@code PUT /api/inventories/{id}/stock} : Update inventory stock level
 *
 * @param id the id of the inventory
 * @param request the stock update request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and updated inventory DTO
 */
@PutMapping("/inventories/{id}/stock")
public Mono<ResponseEntity<InventoryDTO>> updateStock(@PathVariable UUID id, @RequestBody StockUpdateRequestDTO request) {
  log.debug("REST request to update inventory stock : {} - {}", id, request);
  return inventoryService.updateStock(id, request).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<InventoryDTO> updateStock(UUID id, StockUpdateRequestDTO request);

```

### 6.2 Get Low Stock Items

**Endpoint:** `GET /api/inventories/branch/{branchId}/low-stock`
**Purpose:** Get inventory items below minimum stock level

```java
/**
 * {@code GET /api/inventories/branch/{branchId}/low-stock} : Get low stock items
 *
 * @param branchId the branch ID
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of low stock items
 */
@GetMapping("/inventories/branch/{branchId}/low-stock")
public Mono<ResponseEntity<List<InventoryDTO>>> getLowStockItems(@PathVariable UUID branchId) {
  log.debug("REST request to get low stock items for branch : {}", branchId);
  return inventoryService.findLowStockByBranchId(branchId).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<InventoryDTO> findLowStockByBranchId(UUID branchId);

```

### 6.3 Adjust Stock (Add/Remove)

**Endpoint:** `POST /api/inventories/{id}/adjust`
**Purpose:** Adjust inventory stock (add or remove quantity)

```java
/**
 * {@code POST /api/inventories/{id}/adjust} : Adjust inventory stock
 *
 * @param id the id of the inventory
 * @param request the stock adjustment request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and updated inventory DTO
 */
@PostMapping("/inventories/{id}/adjust")
public Mono<ResponseEntity<InventoryDTO>> adjustStock(@PathVariable UUID id, @RequestBody StockAdjustmentRequestDTO request) {
  log.debug("REST request to adjust inventory stock : {} - {}", id, request);
  return inventoryService.adjustStock(id, request).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<InventoryDTO> adjustStock(UUID id, StockAdjustmentRequestDTO request);

```

---

## 7. Order Resource (`OrderResource`)

### 7.1 Create Order (Online/Offline)

**Endpoint:** `POST /api/orders/create`
**Purpose:** Create a new order with items

```java
// jhipster-needle-rest-add-post-method - JHipster will add post methods here

/**
 * {@code POST /api/orders/create} : Create a new order
 *
 * @param orderRequest the order creation request
 * @return the {@link ResponseEntity} with status {@code 201 (Created)} and order DTO
 */
@PostMapping("/orders/create")
public Mono<ResponseEntity<OrderDTO>> createOrder(@RequestBody OrderCreationRequestDTO orderRequest) {
  log.debug("REST request to create order : {}", orderRequest);
  return orderService.createOrder(orderRequest).map(result -> ResponseEntity.status(HttpStatus.CREATED).body(result));
}

```

**Service Method:**

```java
Mono<OrderDTO> createOrder(OrderCreationRequestDTO request);

```

### 7.2 Update Order Status

**Endpoint:** `PUT /api/orders/{id}/status`
**Purpose:** Update order status (workflow: PENDING → CONFIRMED → PREPARING → READY → SERVED → COMPLETED)

```java
/**
 * {@code PUT /api/orders/{id}/status} : Update order status
 *
 * @param id the id of the order
 * @param request the status update request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and updated order DTO
 */
@PutMapping("/orders/{id}/status")
public Mono<ResponseEntity<OrderDTO>> updateOrderStatus(@PathVariable UUID id, @RequestBody OrderStatusUpdateRequestDTO request) {
  log.debug("REST request to update order status : {} - {}", id, request);
  return orderService.updateStatus(id, request).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<OrderDTO> updateStatus(UUID id, OrderStatusUpdateRequestDTO request);

```

### 7.3 Cancel Order

**Endpoint:** `PUT /api/orders/{id}/cancel`
**Purpose:** Cancel an order

```java
/**
 * {@code PUT /api/orders/{id}/cancel} : Cancel an order
 *
 * @param id the id of the order
 * @param request the cancellation request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and cancelled order DTO
 */
@PutMapping("/orders/{id}/cancel")
public Mono<ResponseEntity<OrderDTO>> cancelOrder(@PathVariable UUID id, @RequestBody OrderCancellationRequestDTO request) {
  log.debug("REST request to cancel order : {} - {}", id, request);
  return orderService.cancelOrder(id, request).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<OrderDTO> cancelOrder(UUID id, OrderCancellationRequestDTO request);

```

### 7.4 Get Orders by Status

**Endpoint:** `GET /api/orders/branch/{branchId}/status/{status}`
**Purpose:** Get orders by status for a branch

```java
/**
 * {@code GET /api/orders/branch/{branchId}/status/{status}} : Get orders by status
 *
 * @param branchId the branch ID
 * @param status the order status
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of orders
 */
@GetMapping("/orders/branch/{branchId}/status/{status}")
public Mono<ResponseEntity<List<OrderDTO>>> getOrdersByStatus(@PathVariable UUID branchId, @PathVariable String status) {
  log.debug("REST request to get orders by status : {} - {}", branchId, status);
  return orderService.findByBranchIdAndStatus(branchId, status).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<OrderDTO> findByBranchIdAndStatus(UUID branchId, String status);

```

### 7.5 Get Orders by Date Range

**Endpoint:** `GET /api/orders/branch/{branchId}/date-range`
**Purpose:** Get orders within a date range

```java
/**
 * {@code GET /api/orders/branch/{branchId}/date-range} : Get orders by date range
 *
 * @param branchId the branch ID
 * @param startDate the start date
 * @param endDate the end date
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of orders
 */
@GetMapping("/orders/branch/{branchId}/date-range")
public Mono<ResponseEntity<List<OrderDTO>>> getOrdersByDateRange(
  @PathVariable UUID branchId,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Instant startDate,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Instant endDate
) {
  log.debug("REST request to get orders by date range : {} - {} to {}", branchId, startDate, endDate);
  return orderService
    .findByBranchIdAndDateRange(branchId, startDate, endDate)
    .collectList()
    .map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<OrderDTO> findByBranchIdAndDateRange(UUID branchId, Instant startDate, Instant endDate);

```

### 7.6 Get Order with Items

**Endpoint:** `GET /api/orders/{id}/with-items`
**Purpose:** Get order with all items and customizations

```java
/**
 * {@code GET /api/orders/{id}/with-items} : Get order with items
 *
 * @param id the id of the order
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and order with items DTO
 */
@GetMapping("/orders/{id}/with-items")
public Mono<ResponseEntity<OrderWithItemsDTO>> getOrderWithItems(@PathVariable UUID id) {
  log.debug("REST request to get order with items : {}", id);
  return orderService
    .findOrderWithItems(id)
    .map(result -> ResponseEntity.ok().body(result))
    .switchIfEmpty(Mono.just(ResponseEntity.notFound().build()));
}

```

**Service Method:**

```java
Mono<OrderWithItemsDTO> findOrderWithItems(UUID id);

```

---

## 8. Bill Resource (`BillResource`)

### 8.1 Generate Bill from Order

**Endpoint:** `POST /api/bills/generate`
**Purpose:** Generate a bill from an order with tax and discount calculations

```java
// jhipster-needle-rest-add-post-method - JHipster will add post methods here

/**
 * {@code POST /api/bills/generate} : Generate bill from order
 *
 * @param request the bill generation request
 * @return the {@link ResponseEntity} with status {@code 201 (Created)} and bill DTO
 */
@PostMapping("/bills/generate")
public Mono<ResponseEntity<BillDTO>> generateBill(@RequestBody BillGenerationRequestDTO request) {
  log.debug("REST request to generate bill : {}", request);
  return billService.generateBillFromOrder(request).map(result -> ResponseEntity.status(HttpStatus.CREATED).body(result));
}

```

**Service Method:**

```java
Mono<BillDTO> generateBillFromOrder(BillGenerationRequestDTO request);

```

### 8.2 Get Bill with Breakdown

**Endpoint:** `GET /api/bills/{id}/breakdown`
**Purpose:** Get bill with item, tax, and discount breakdown

```java
/**
 * {@code GET /api/bills/{id}/breakdown} : Get bill with breakdown
 *
 * @param id the id of the bill
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and bill breakdown DTO
 */
@GetMapping("/bills/{id}/breakdown")
public Mono<ResponseEntity<BillBreakdownDTO>> getBillBreakdown(@PathVariable UUID id) {
  log.debug("REST request to get bill breakdown : {}", id);
  return billService
    .getBillBreakdown(id)
    .map(result -> ResponseEntity.ok().body(result))
    .switchIfEmpty(Mono.just(ResponseEntity.notFound().build()));
}

```

**Service Method:**

```java
Mono<BillBreakdownDTO> getBillBreakdown(UUID id);

```

### 8.3 Apply Discount to Bill

**Endpoint:** `POST /api/bills/{id}/apply-discount`
**Purpose:** Apply a discount to a bill

```java
/**
 * {@code POST /api/bills/{id}/apply-discount} : Apply discount to bill
 *
 * @param id the id of the bill
 * @param request the discount application request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and updated bill DTO
 */
@PostMapping("/bills/{id}/apply-discount")
public Mono<ResponseEntity<BillDTO>> applyDiscount(@PathVariable UUID id, @RequestBody DiscountApplicationRequestDTO request) {
  log.debug("REST request to apply discount to bill : {} - {}", id, request);
  return billService.applyDiscount(id, request).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<BillDTO> applyDiscount(UUID id, DiscountApplicationRequestDTO request);

```

### 8.4 Get Bills by Date Range

**Endpoint:** `GET /api/bills/branch/{branchId}/date-range`
**Purpose:** Get bills within a date range for reporting

```java
/**
 * {@code GET /api/bills/branch/{branchId}/date-range} : Get bills by date range
 *
 * @param branchId the branch ID
 * @param startDate the start date
 * @param endDate the end date
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of bills
 */
@GetMapping("/bills/branch/{branchId}/date-range")
public Mono<ResponseEntity<List<BillDTO>>> getBillsByDateRange(
  @PathVariable UUID branchId,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Instant startDate,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Instant endDate
) {
  log.debug("REST request to get bills by date range : {} - {} to {}", branchId, startDate, endDate);
  return billService.findByBranchIdAndDateRange(branchId, startDate, endDate).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<BillDTO> findByBranchIdAndDateRange(UUID branchId, Instant startDate, Instant endDate);

```

---

## 9. Payment Resource (`PaymentResource`)

### 9.1 Process Payment

**Endpoint:** `POST /api/payments/process`
**Purpose:** Process a payment for a bill

```java
// jhipster-needle-rest-add-post-method - JHipster will add post methods here

/**
 * {@code POST /api/payments/process} : Process payment for a bill
 *
 * @param request the payment request
 * @return the {@link ResponseEntity} with status {@code 201 (Created)} and payment DTO
 */
@PostMapping("/payments/process")
public Mono<ResponseEntity<PaymentDTO>> processPayment(@RequestBody PaymentRequestDTO request) {
  log.debug("REST request to process payment : {}", request);
  return paymentService.processPayment(request).map(result -> ResponseEntity.status(HttpStatus.CREATED).body(result));
}

```

**Service Method:**

```java
Mono<PaymentDTO> processPayment(PaymentRequestDTO request);

```

### 9.2 Process Partial Payment

**Endpoint:** `POST /api/payments/process-partial`
**Purpose:** Process a partial payment for a bill

```java
/**
 * {@code POST /api/payments/process-partial} : Process partial payment
 *
 * @param request the partial payment request
 * @return the {@link ResponseEntity} with status {@code 201 (Created)} and payment DTO
 */
@PostMapping("/payments/process-partial")
public Mono<ResponseEntity<PaymentDTO>> processPartialPayment(@RequestBody PartialPaymentRequestDTO request) {
  log.debug("REST request to process partial payment : {}", request);
  return paymentService.processPartialPayment(request).map(result -> ResponseEntity.status(HttpStatus.CREATED).body(result));
}

```

**Service Method:**

```java
Mono<PaymentDTO> processPartialPayment(PartialPaymentRequestDTO request);

```

### 9.3 Process Refund

**Endpoint:** `POST /api/payments/{id}/refund`
**Purpose:** Process a refund for a payment

```java
/**
 * {@code POST /api/payments/{id}/refund} : Process refund
 *
 * @param id the id of the payment
 * @param request the refund request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and refunded payment DTO
 */
@PostMapping("/payments/{id}/refund")
public Mono<ResponseEntity<PaymentDTO>> processRefund(@PathVariable UUID id, @RequestBody RefundRequestDTO request) {
  log.debug("REST request to process refund : {} - {}", id, request);
  return paymentService.processRefund(id, request).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<PaymentDTO> processRefund(UUID id, RefundRequestDTO request);

```

### 9.4 Get Payments by Bill

**Endpoint:** `GET /api/payments/bill/{billId}`
**Purpose:** Get all payments for a bill

```java
/**
 * {@code GET /api/payments/bill/{billId}} : Get payments by bill
 *
 * @param billId the bill ID
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of payments
 */
@GetMapping("/payments/bill/{billId}")
public Mono<ResponseEntity<List<PaymentDTO>>> getPaymentsByBill(@PathVariable UUID billId) {
  log.debug("REST request to get payments by bill : {}", billId);
  return paymentService.findByBillId(billId).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<PaymentDTO> findByBillId(UUID billId);

```

### 9.5 Get Payment Summary by Method

**Endpoint:** `GET /api/payments/branch/{branchId}/summary`
**Purpose:** Get payment summary grouped by payment method

```java
/**
 * {@code GET /api/payments/branch/{branchId}/summary} : Get payment summary
 *
 * @param branchId the branch ID
 * @param startDate the start date
 * @param endDate the end date
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and payment summary
 */
@GetMapping("/payments/branch/{branchId}/summary")
public Mono<ResponseEntity<PaymentSummaryDTO>> getPaymentSummary(
  @PathVariable UUID branchId,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Instant startDate,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Instant endDate
) {
  log.debug("REST request to get payment summary : {} - {} to {}", branchId, startDate, endDate);
  return paymentService.getPaymentSummary(branchId, startDate, endDate).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<PaymentSummaryDTO> getPaymentSummary(UUID branchId, Instant startDate, Instant endDate);

```

---

## 10. Customer Resource (`CustomerResource`)

### 10.1 Get Customer Orders

**Endpoint:** `GET /api/customers/{id}/orders`
**Purpose:** Get all orders for a customer

```java
// jhipster-needle-rest-add-get-method - JHipster will add get methods here

/**
 * {@code GET /api/customers/{id}/orders} : Get customer orders
 *
 * @param id the id of the customer
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of orders
 */
@GetMapping("/customers/{id}/orders")
public Mono<ResponseEntity<List<OrderDTO>>> getCustomerOrders(@PathVariable UUID id) {
  log.debug("REST request to get customer orders : {}", id);
  return customerService.getCustomerOrders(id).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<OrderDTO> getCustomerOrders(UUID customerId);

```

### 10.2 Get Customer Loyalty Points

**Endpoint:** `GET /api/customers/{id}/loyalty`
**Purpose:** Get customer loyalty information

```java
/**
 * {@code GET /api/customers/{id}/loyalty} : Get customer loyalty
 *
 * @param id the id of the customer
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and loyalty DTO
 */
@GetMapping("/customers/{id}/loyalty")
public Mono<ResponseEntity<CustomerLoyaltyDTO>> getCustomerLoyalty(@PathVariable UUID id) {
  log.debug("REST request to get customer loyalty : {}", id);
  return customerLoyaltyService
    .findByCustomerId(id)
    .map(result -> ResponseEntity.ok().body(result))
    .switchIfEmpty(Mono.just(ResponseEntity.notFound().build()));
}

```

**Service Method (in CustomerLoyaltyService):**

```java
Mono<CustomerLoyaltyDTO> findByCustomerId(UUID customerId);

```

### 10.3 Add Loyalty Points

**Endpoint:** `POST /api/customers/{id}/loyalty/add-points`
**Purpose:** Add loyalty points to a customer

```java
/**
 * {@code POST /api/customers/{id}/loyalty/add-points} : Add loyalty points
 *
 * @param id the id of the customer
 * @param request the points addition request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and updated loyalty DTO
 */
@PostMapping("/customers/{id}/loyalty/add-points")
public Mono<ResponseEntity<CustomerLoyaltyDTO>> addLoyaltyPoints(@PathVariable UUID id, @RequestBody LoyaltyPointsRequestDTO request) {
  log.debug("REST request to add loyalty points : {} - {}", id, request);
  return customerLoyaltyService.addPoints(id, request).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method (in CustomerLoyaltyService):**

```java
Mono<CustomerLoyaltyDTO> addPoints(UUID customerId, LoyaltyPointsRequestDTO request);

```

---

## 11. Discount Resource (`DiscountResource`)

### 11.1 Validate Discount Code

**Endpoint:** `POST /api/discounts/validate`
**Purpose:** Validate a discount code and get discount details

```java
// jhipster-needle-rest-add-post-method - JHipster will add post methods here

/**
 * {@code POST /api/discounts/validate} : Validate discount code
 *
 * @param request the discount validation request
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and discount validation result
 */
@PostMapping("/discounts/validate")
public Mono<ResponseEntity<DiscountValidationDTO>> validateDiscount(@RequestBody DiscountValidationRequestDTO request) {
  log.debug("REST request to validate discount : {}", request);
  return discountService.validateDiscount(request).map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Mono<DiscountValidationDTO> validateDiscount(DiscountValidationRequestDTO request);

```

### 11.2 Get Active Discounts

**Endpoint:** `GET /api/discounts/restaurant/{restaurantId}/active`
**Purpose:** Get all active discounts for a restaurant

```java
/**
 * {@code GET /api/discounts/restaurant/{restaurantId}/active} : Get active discounts
 *
 * @param restaurantId the restaurant ID
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and list of discounts
 */
@GetMapping("/discounts/restaurant/{restaurantId}/active")
public Mono<ResponseEntity<List<DiscountDTO>>> getActiveDiscounts(@PathVariable UUID restaurantId) {
  log.debug("REST request to get active discounts : {}", restaurantId);
  return discountService.findActiveByRestaurantId(restaurantId).collectList().map(result -> ResponseEntity.ok().body(result));
}

```

**Service Method:**

```java
Flux<DiscountDTO> findActiveByRestaurantId(UUID restaurantId);

```

---

## 12. Reporting Endpoints

### 12.1 Sales Report

**Endpoint:** `GET /api/reports/sales`
**Purpose:** Get sales report for a branch/date range

```java
// Create new ReportResource.java

/**
 * {@code GET /api/reports/sales} : Get sales report
 *
 * @param branchId the branch ID
 * @param startDate the start date
 * @param endDate the end date
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and sales report
 */
@GetMapping("/reports/sales")
public Mono<ResponseEntity<SalesReportDTO>> getSalesReport(
  @RequestParam UUID branchId,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Instant startDate,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE_TIME) Instant endDate
) {
  log.debug("REST request to get sales report : {} - {} to {}", branchId, startDate, endDate);
  return reportService.getSalesReport(branchId, startDate, endDate).map(result -> ResponseEntity.ok().body(result));
}

```

### 12.2 Daily Summary Report

**Endpoint:** `GET /api/reports/daily-summary`
**Purpose:** Get daily summary report

```java
/**
 * {@code GET /api/reports/daily-summary} : Get daily summary report
 *
 * @param branchId the branch ID
 * @param date the date
 * @return the {@link ResponseEntity} with status {@code 200 (OK)} and daily summary
 */
@GetMapping("/reports/daily-summary")
public Mono<ResponseEntity<DailySummaryReportDTO>> getDailySummary(
  @RequestParam UUID branchId,
  @RequestParam @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) LocalDate date
) {
  log.debug("REST request to get daily summary : {} - {}", branchId, date);
  return reportService.getDailySummary(branchId, date).map(result -> ResponseEntity.ok().body(result));
}

```

---

## Summary Table

| Resource                | Custom Endpoints                                                                     | Count |
| ----------------------- | ------------------------------------------------------------------------------------ | ----- |
| RmsUserResource         | sync, findByExternalId, bulkSync                                                     | 3     |
| UserBranchRoleResource  | assignRole, revokeRole, findByBranchAndRole                                          | 3     |
| BranchTableResource     | updateStatus, findAvailable, findByStatus                                            | 3     |
| TableAssignmentResource | createDailyAssignments, findByDate, assignWaiters                                    | 3     |
| MenuItemResource        | updateAvailability, findAvailable, findByCategory, findFiltered                      | 4     |
| InventoryResource       | updateStock, findLowStock, adjustStock                                               | 3     |
| OrderResource           | createOrder, updateStatus, cancelOrder, findByStatus, findByDateRange, findWithItems | 6     |
| BillResource            | generateBill, getBreakdown, applyDiscount, findByDateRange                           | 4     |
| PaymentResource         | processPayment, processPartialPayment, processRefund, findByBill, getSummary         | 5     |
| CustomerResource        | getOrders, getLoyalty, addLoyaltyPoints                                              | 3     |
| DiscountResource        | validateDiscount, findActive                                                         | 2     |
| ReportResource          | getSalesReport, getDailySummary                                                      | 2     |

**Total Custom Endpoints: 41**

---

## Implementation Notes

1. **Place custom code below JHipster markers** to preserve during regeneration
2. **Create DTOs** for request/response objects (not included in JDL)
3. **Add validation** using Jakarta Bean Validation
4. **Handle errors** using existing exception handling
5. **Add security** annotations (`@PreAuthorize`) for role-based access
6. **Add logging** for all custom endpoints
7. **Write tests** for all custom endpoints

## DTOs to Create

1. `UserBranchRoleAssignmentDTO`
2. `StockUpdateRequestDTO`
3. `StockAdjustmentRequestDTO`
4. `OrderCreationRequestDTO`
5. `OrderStatusUpdateRequestDTO`
6. `OrderCancellationRequestDTO`
7. `OrderWithItemsDTO`
8. `BillGenerationRequestDTO`
9. `BillBreakdownDTO`
10. `DiscountApplicationRequestDTO`
11. `PaymentRequestDTO`
12. `PartialPaymentRequestDTO`
13. `RefundRequestDTO`
14. `PaymentSummaryDTO`
15. `LoyaltyPointsRequestDTO`
16. `DiscountValidationRequestDTO`
17. `DiscountValidationDTO`
18. `SalesReportDTO`
19. `DailySummaryReportDTO`
20. `DailyTableAssignmentRequestDTO`
